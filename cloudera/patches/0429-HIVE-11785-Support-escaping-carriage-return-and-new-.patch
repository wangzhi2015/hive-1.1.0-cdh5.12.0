From 8590e4364c5c4c82540fa7cebf17eb2b096d3900 Mon Sep 17 00:00:00 2001
From: Aihua Xu <aihuaxu@gmail.com>
Date: Fri, 16 Oct 2015 11:58:37 -0700
Subject: [PATCH 0429/1164] HIVE-11785: Support escaping carriage return and
 new line for LazySimpleSerDe (Aihua Xu, reviewed
 by Chao Sun)

Change-Id: I74b41d3065646b2b1ae17acfea964a3d33504e72
---
 .../hive/contrib/serde2/MultiDelimitSerDe.java     |    1 +
 data/files/escape_crlf.txt                         |    2 +
 .../org/apache/hadoop/hive/hbase/HBaseSerDe.java   |    1 +
 .../org/apache/hadoop/hive/ql/plan/PlanUtils.java  |    3 +-
 ql/src/test/queries/clientpositive/escape_crlf.q   |   19 ++++
 .../clientpositive/alter_partition_coltype.q.out   |    3 +
 .../auto_join_reordering_values.q.out              |    1 +
 .../clientpositive/auto_sortmerge_join_1.q.out     |    5 +
 .../clientpositive/auto_sortmerge_join_11.q.out    |    4 +
 .../clientpositive/auto_sortmerge_join_12.q.out    |    1 +
 .../clientpositive/auto_sortmerge_join_2.q.out     |    4 +
 .../clientpositive/auto_sortmerge_join_3.q.out     |    5 +
 .../clientpositive/auto_sortmerge_join_4.q.out     |    5 +
 .../clientpositive/auto_sortmerge_join_5.q.out     |    5 +
 .../clientpositive/auto_sortmerge_join_7.q.out     |    5 +
 .../clientpositive/auto_sortmerge_join_8.q.out     |    5 +
 .../results/clientpositive/bucket_map_join_1.q.out |    1 +
 .../results/clientpositive/bucket_map_join_2.q.out |    1 +
 .../clientpositive/bucket_map_join_spark4.q.out    |    2 +
 .../results/clientpositive/bucketcontext_1.q.out   |    2 +
 .../results/clientpositive/bucketcontext_2.q.out   |    2 +
 .../results/clientpositive/bucketcontext_3.q.out   |    2 +
 .../results/clientpositive/bucketcontext_4.q.out   |    2 +
 .../results/clientpositive/bucketcontext_5.q.out   |    2 +
 .../results/clientpositive/bucketcontext_6.q.out   |    2 +
 .../results/clientpositive/bucketcontext_7.q.out   |    2 +
 .../results/clientpositive/bucketcontext_8.q.out   |    2 +
 .../results/clientpositive/bucketmapjoin10.q.out   |    1 +
 .../results/clientpositive/bucketmapjoin11.q.out   |    2 +
 .../results/clientpositive/bucketmapjoin12.q.out   |    2 +
 .../results/clientpositive/bucketmapjoin13.q.out   |    4 +
 .../results/clientpositive/bucketmapjoin7.q.out    |    1 +
 .../results/clientpositive/bucketmapjoin8.q.out    |    2 +
 .../results/clientpositive/bucketmapjoin9.q.out    |    2 +
 .../clientpositive/bucketmapjoin_negative3.q.out   |    9 ++
 .../clientpositive/columnstats_partlvl.q.out       |    2 +
 .../clientpositive/columnstats_tbllvl.q.out        |    1 +
 ql/src/test/results/clientpositive/combine2.q.out  |    1 +
 .../constantPropagateForSubQuery.q.out             |    1 +
 .../clientpositive/display_colstats_tbllvl.q.out   |    1 +
 .../encryption_join_unencrypted_tbl.q.out          |    1 +
 ...ption_join_with_different_encryption_keys.q.out |    1 +
 .../test/results/clientpositive/escape_crlf.q.out  |   98 ++++++++++++++++++++
 .../clientpositive/filter_join_breaktask.q.out     |    1 +
 .../results/clientpositive/groupby_sort_1_23.q.out |    1 +
 .../clientpositive/groupby_sort_skew_1_23.q.out    |    1 +
 ql/src/test/results/clientpositive/input23.q.out   |    1 +
 .../test/results/clientpositive/input_part7.q.out  |    1 +
 .../clientpositive/join_filters_overlap.q.out      |    5 +
 .../clientpositive/list_bucket_dml_14.q.out        |    1 +
 .../list_bucket_query_multiskew_3.q.out            |    1 +
 .../list_bucket_query_oneskew_2.q.out              |    2 +
 .../results/clientpositive/louter_join_ppr.q.out   |    4 +
 .../results/clientpositive/mapjoin_mapjoin.q.out   |    1 +
 .../results/clientpositive/metadataonly1.q.out     |    9 ++
 .../results/clientpositive/optimize_nullscan.q.out |   10 ++
 .../clientpositive/outer_join_ppr.q.java1.7.out    |    2 +
 ql/src/test/results/clientpositive/pcr.q.out       |   17 ++++
 .../results/clientpositive/ppd_join_filter.q.out   |    4 +
 .../results/clientpositive/ppd_union_view.q.out    |    3 +
 ql/src/test/results/clientpositive/ppd_vc.q.out    |    2 +
 .../clientpositive/ppr_allchildsarenull.q.out      |    2 +
 ql/src/test/results/clientpositive/push_or.q.out   |    1 +
 .../clientpositive/query_result_fileformat.q.out   |    6 +-
 .../clientpositive/rand_partitionpruner1.q.out     |    1 +
 .../results/clientpositive/regexp_extract.q.out    |    2 +
 .../results/clientpositive/remote_script.q.out     |    8 +-
 .../results/clientpositive/router_join_ppr.q.out   |    4 +
 ql/src/test/results/clientpositive/sample10.q.out  |    1 +
 ql/src/test/results/clientpositive/sample6.q.out   |    7 ++
 ql/src/test/results/clientpositive/sample8.q.out   |    1 +
 ql/src/test/results/clientpositive/sample9.q.out   |    1 +
 .../clientpositive/serde_user_properties.q.out     |    3 +
 .../results/clientpositive/smb_mapjoin_11.q.out    |    2 +
 .../results/clientpositive/smb_mapjoin_13.q.out    |    2 +
 .../results/clientpositive/smb_mapjoin_15.q.out    |    4 +
 .../clientpositive/sort_merge_join_desc_5.q.out    |    1 +
 .../clientpositive/sort_merge_join_desc_6.q.out    |    1 +
 .../clientpositive/sort_merge_join_desc_7.q.out    |    1 +
 .../spark/auto_join_reordering_values.q.out        |    1 +
 .../spark/auto_sortmerge_join_1.q.out              |    3 +
 .../spark/auto_sortmerge_join_12.q.out             |    1 +
 .../spark/auto_sortmerge_join_2.q.out              |    2 +
 .../spark/auto_sortmerge_join_3.q.out              |    3 +
 .../spark/auto_sortmerge_join_4.q.out              |    3 +
 .../spark/auto_sortmerge_join_5.q.out              |    3 +
 .../spark/auto_sortmerge_join_7.q.out              |    3 +
 .../spark/auto_sortmerge_join_8.q.out              |    3 +
 .../clientpositive/spark/bucket_map_join_1.q.out   |    1 +
 .../clientpositive/spark/bucket_map_join_2.q.out   |    1 +
 .../spark/bucket_map_join_spark4.q.out             |    2 +
 .../clientpositive/spark/bucketmapjoin10.q.out     |    1 +
 .../clientpositive/spark/bucketmapjoin11.q.out     |    2 +
 .../clientpositive/spark/bucketmapjoin12.q.out     |    2 +
 .../clientpositive/spark/bucketmapjoin13.q.out     |    4 +
 .../clientpositive/spark/bucketmapjoin7.q.out      |    1 +
 .../clientpositive/spark/bucketmapjoin8.q.out      |    2 +
 .../clientpositive/spark/bucketmapjoin9.q.out      |    2 +
 .../spark/bucketmapjoin_negative3.q.out            |    9 ++
 .../spark/filter_join_breaktask.q.out              |    1 +
 .../clientpositive/spark/groupby_sort_1_23.q.out   |    1 +
 .../spark/groupby_sort_skew_1_23.q.out             |    1 +
 .../spark/join_filters_overlap.q.out               |    5 +
 .../clientpositive/spark/louter_join_ppr.q.out     |    4 +
 .../clientpositive/spark/mapjoin_mapjoin.q.out     |    1 +
 .../clientpositive/spark/optimize_nullscan.q.out   |    9 ++
 .../spark/outer_join_ppr.q.java1.7.out             |    2 +
 ql/src/test/results/clientpositive/spark/pcr.q.out |   17 ++++
 .../clientpositive/spark/ppd_join_filter.q.out     |    4 +
 .../clientpositive/spark/remote_script.q.out       |    8 +-
 .../clientpositive/spark/router_join_ppr.q.out     |    4 +
 .../results/clientpositive/spark/sample10.q.out    |    1 +
 .../results/clientpositive/spark/sample6.q.out     |    7 ++
 .../results/clientpositive/spark/sample8.q.out     |    1 +
 .../clientpositive/spark/smb_mapjoin_13.q.out      |    2 +
 .../clientpositive/spark/smb_mapjoin_15.q.out      |    4 +
 .../clientpositive/spark/transform_ppr1.q.out      |    1 +
 .../clientpositive/spark/transform_ppr2.q.out      |    1 +
 .../results/clientpositive/spark/union_ppr.q.out   |    1 +
 .../clientpositive/spark/vectorized_ptf.q.out      |   22 +++++
 .../temp_table_display_colstats_tbllvl.q.out       |    1 +
 .../clientpositive/tez/auto_sortmerge_join_1.q.out |    3 +
 .../tez/auto_sortmerge_join_11.q.out               |    4 +
 .../tez/auto_sortmerge_join_12.q.out               |    1 +
 .../clientpositive/tez/auto_sortmerge_join_2.q.out |    2 +
 .../clientpositive/tez/auto_sortmerge_join_3.q.out |    3 +
 .../clientpositive/tez/auto_sortmerge_join_4.q.out |    3 +
 .../clientpositive/tez/auto_sortmerge_join_5.q.out |    3 +
 .../clientpositive/tez/auto_sortmerge_join_7.q.out |    3 +
 .../clientpositive/tez/auto_sortmerge_join_8.q.out |    3 +
 .../clientpositive/tez/filter_join_breaktask.q.out |    1 +
 .../clientpositive/tez/mapjoin_mapjoin.q.out       |    1 +
 .../results/clientpositive/tez/metadataonly1.q.out |    9 ++
 .../clientpositive/tez/optimize_nullscan.q.out     |    8 ++
 .../clientpositive/tez/transform_ppr1.q.out        |    1 +
 .../clientpositive/tez/transform_ppr2.q.out        |    1 +
 .../clientpositive/tez/vectorized_ptf.q.out        |   22 +++++
 .../results/clientpositive/transform_ppr1.q.out    |    1 +
 .../results/clientpositive/transform_ppr2.q.out    |    1 +
 .../test/results/clientpositive/udf_explode.q.out  |    2 +
 .../test/results/clientpositive/udtf_explode.q.out |    2 +
 ql/src/test/results/clientpositive/union24.q.out   |   10 ++
 ql/src/test/results/clientpositive/union_ppr.q.out |    1 +
 .../results/clientpositive/vectorized_ptf.q.out    |   22 +++++
 serde/if/serde.thrift                              |    1 +
 serde/src/gen/thrift/gen-cpp/serde_constants.cpp   |    2 +
 serde/src/gen/thrift/gen-cpp/serde_constants.h     |    1 +
 .../apache/hadoop/hive/serde/serdeConstants.java   |    2 +
 .../gen-php/org/apache/hadoop/hive/serde/Types.php |    2 +
 .../org_apache_hadoop_hive_serde/constants.py      |    1 +
 serde/src/gen/thrift/gen-rb/serde_constants.rb     |    2 +
 .../hadoop/hive/serde2/columnar/ColumnarSerDe.java |    6 +-
 .../hive/serde2/lazy/LazySerDeParameters.java      |   38 ++++++--
 .../hadoop/hive/serde2/lazy/LazySimpleSerDe.java   |    7 +-
 .../apache/hadoop/hive/serde2/lazy/LazyUtils.java  |   32 +++++--
 155 files changed, 640 insertions(+), 40 deletions(-)
 create mode 100644 data/files/escape_crlf.txt
 create mode 100644 ql/src/test/queries/clientpositive/escape_crlf.q
 create mode 100644 ql/src/test/results/clientpositive/escape_crlf.q.out

diff --git a/contrib/src/java/org/apache/hadoop/hive/contrib/serde2/MultiDelimitSerDe.java b/contrib/src/java/org/apache/hadoop/hive/contrib/serde2/MultiDelimitSerDe.java
index 957804a..3e1be7d 100644
--- a/contrib/src/java/org/apache/hadoop/hive/contrib/serde2/MultiDelimitSerDe.java
+++ b/contrib/src/java/org/apache/hadoop/hive/contrib/serde2/MultiDelimitSerDe.java
@@ -60,6 +60,7 @@
     serdeConstants.LIST_COLUMNS, serdeConstants.LIST_COLUMN_TYPES,
     serdeConstants.FIELD_DELIM, serdeConstants.COLLECTION_DELIM, serdeConstants.MAPKEY_DELIM,
     serdeConstants.SERIALIZATION_FORMAT, serdeConstants.SERIALIZATION_NULL_FORMAT,
+    serdeConstants.SERIALIZATION_ESCAPE_CRLF,
     serdeConstants.SERIALIZATION_LAST_COLUMN_TAKES_REST,
     serdeConstants.ESCAPE_CHAR,
     serdeConstants.SERIALIZATION_ENCODING,
diff --git a/data/files/escape_crlf.txt b/data/files/escape_crlf.txt
new file mode 100644
index 0000000..88a83c2
--- /dev/null
+++ b/data/files/escape_crlf.txt
@@ -0,0 +1,2 @@
+This\nis\rthe first\r\nmulti-line field|field1-2
+This\nis\rthe second\r\nmulti-line field|field2-2
diff --git a/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HBaseSerDe.java b/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HBaseSerDe.java
index e843bd8..254b5a6 100644
--- a/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HBaseSerDe.java
+++ b/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HBaseSerDe.java
@@ -48,6 +48,7 @@
     serdeConstants.LIST_COLUMNS, serdeConstants.LIST_COLUMN_TYPES,
     serdeConstants.FIELD_DELIM, serdeConstants.COLLECTION_DELIM, serdeConstants.MAPKEY_DELIM,
     serdeConstants.SERIALIZATION_FORMAT, serdeConstants.SERIALIZATION_NULL_FORMAT,
+    serdeConstants.SERIALIZATION_ESCAPE_CRLF,
     serdeConstants.SERIALIZATION_LAST_COLUMN_TAKES_REST,
     serdeConstants.ESCAPE_CHAR,
     serdeConstants.SERIALIZATION_ENCODING,
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
index 69f7c5d..b9391c4 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
@@ -287,9 +287,10 @@ public static TableDesc getDefaultQueryOutputTableDesc(String cols, String colTy
         false, false, fileFormat);
     //enable escaping
     tblDesc.getProperties().setProperty(serdeConstants.ESCAPE_CHAR, "\\");
+    tblDesc.getProperties().setProperty(serdeConstants.SERIALIZATION_ESCAPE_CRLF, "true");
     //enable extended nesting levels
     tblDesc.getProperties().setProperty(
-    		LazySerDeParameters.SERIALIZATION_EXTEND_ADDITIONAL_NESTING_LEVELS, "true");
+        LazySerDeParameters.SERIALIZATION_EXTEND_ADDITIONAL_NESTING_LEVELS, "true");
     return tblDesc;
   }
 
diff --git a/ql/src/test/queries/clientpositive/escape_crlf.q b/ql/src/test/queries/clientpositive/escape_crlf.q
new file mode 100644
index 0000000..2d6e05e
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/escape_crlf.q
@@ -0,0 +1,19 @@
+DROP TABLE IF EXISTS base_tab;
+CREATE TABLE base_tab(a STRING, b STRING)
+ROW FORMAT DELIMITED
+    FIELDS TERMINATED BY '|';
+DESCRIBE EXTENDED base_tab;
+
+LOAD DATA LOCAL INPATH '../../data/files/escape_crlf.txt' OVERWRITE INTO TABLE base_tab;
+-- No crlf escaping
+SELECT * FROM base_tab;
+
+-- Crlf escaping
+ALTER TABLE base_tab SET SERDEPROPERTIES ('escape.delim'='\\', 'serialization.escape.crlf'='true');
+SELECT * FROM base_tab;
+
+SET hive.fetch.task.conversion=none;
+-- Make sure intermediate serde works correctly
+SELECT * FROM base_tab;
+
+DROP TABLE base_tab;
diff --git a/ql/src/test/results/clientpositive/alter_partition_coltype.q.out b/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
index af9d96c..bd04a48 100644
--- a/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
@@ -256,6 +256,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -434,6 +435,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -591,6 +593,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/auto_join_reordering_values.q.out b/ql/src/test/results/clientpositive/auto_join_reordering_values.q.out
index 9e3ebec..3a0e7d7 100644
--- a/ql/src/test/results/clientpositive/auto_join_reordering_values.q.out
+++ b/ql/src/test/results/clientpositive/auto_join_reordering_values.q.out
@@ -668,6 +668,7 @@ STAGE PLANS:
                       columns.types string:int
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out
index facf6f4..ae77d2f 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out
@@ -295,6 +295,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -515,6 +516,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -861,6 +863,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1182,6 +1185,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1338,6 +1342,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out
index e6e7ef3..5dad0fb 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out
@@ -413,6 +413,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -763,6 +764,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1072,6 +1074,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1509,6 +1512,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out
index b2e782f..b1ba148 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out
@@ -720,6 +720,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out
index 052318c..bcd041c 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out
@@ -275,6 +275,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -623,6 +624,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -944,6 +946,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1100,6 +1103,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out
index a437e79..74dc246 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out
@@ -226,6 +226,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -397,6 +398,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -787,6 +789,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1061,6 +1064,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1168,6 +1172,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out
index 81ab267..e653eed 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out
@@ -242,6 +242,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -413,6 +414,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -803,6 +805,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1077,6 +1080,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1184,6 +1188,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
index 19da9c9..8b85be5 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
@@ -203,6 +203,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -364,6 +365,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -595,6 +597,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -760,6 +763,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -863,6 +867,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out
index 5b28bc0..2f6ffef 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out
@@ -308,6 +308,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -530,6 +531,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -971,6 +973,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1340,6 +1343,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1496,6 +1500,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out
index c3dfd20..d87b811 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out
@@ -308,6 +308,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -530,6 +531,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -973,6 +975,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1342,6 +1345,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1498,6 +1502,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucket_map_join_1.q.out b/ql/src/test/results/clientpositive/bucket_map_join_1.q.out
index 42e6a3f..ce0df01 100644
--- a/ql/src/test/results/clientpositive/bucket_map_join_1.q.out
+++ b/ql/src/test/results/clientpositive/bucket_map_join_1.q.out
@@ -238,6 +238,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucket_map_join_2.q.out b/ql/src/test/results/clientpositive/bucket_map_join_2.q.out
index af73309..791e606 100644
--- a/ql/src/test/results/clientpositive/bucket_map_join_2.q.out
+++ b/ql/src/test/results/clientpositive/bucket_map_join_2.q.out
@@ -238,6 +238,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucket_map_join_spark4.q.out b/ql/src/test/results/clientpositive/bucket_map_join_spark4.q.out
index bdbcd25..41a2ea9 100644
--- a/ql/src/test/results/clientpositive/bucket_map_join_spark4.q.out
+++ b/ql/src/test/results/clientpositive/bucket_map_join_spark4.q.out
@@ -230,6 +230,7 @@ STAGE PLANS:
                             columns.types int:string:string:string
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -634,6 +635,7 @@ STAGE PLANS:
                             columns.types int:string:string:string
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketcontext_1.q.out b/ql/src/test/results/clientpositive/bucketcontext_1.q.out
index 37e0514..e08fa69 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_1.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_1.q.out
@@ -379,6 +379,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -604,6 +605,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketcontext_2.q.out b/ql/src/test/results/clientpositive/bucketcontext_2.q.out
index 5cb6845..5d8581c 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_2.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_2.q.out
@@ -363,6 +363,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -588,6 +589,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketcontext_3.q.out b/ql/src/test/results/clientpositive/bucketcontext_3.q.out
index 2433a67..55c0f29 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_3.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_3.q.out
@@ -360,6 +360,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -536,6 +537,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketcontext_4.q.out b/ql/src/test/results/clientpositive/bucketcontext_4.q.out
index c039126..febb618 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_4.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_4.q.out
@@ -376,6 +376,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -552,6 +553,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketcontext_5.q.out b/ql/src/test/results/clientpositive/bucketcontext_5.q.out
index 4b9ade6..e02b742 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_5.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_5.q.out
@@ -244,6 +244,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -410,6 +411,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketcontext_6.q.out b/ql/src/test/results/clientpositive/bucketcontext_6.q.out
index 66c159b..68744d1 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_6.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_6.q.out
@@ -315,6 +315,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -538,6 +539,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketcontext_7.q.out b/ql/src/test/results/clientpositive/bucketcontext_7.q.out
index 4228a4d..30b4161 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_7.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_7.q.out
@@ -442,6 +442,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -669,6 +670,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketcontext_8.q.out b/ql/src/test/results/clientpositive/bucketcontext_8.q.out
index dfa0cd8..e1fc923 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_8.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_8.q.out
@@ -442,6 +442,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -669,6 +670,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin10.q.out b/ql/src/test/results/clientpositive/bucketmapjoin10.q.out
index b0e849d..38de15b 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin10.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin10.q.out
@@ -464,6 +464,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin11.q.out b/ql/src/test/results/clientpositive/bucketmapjoin11.q.out
index 4263cab..cf79f7b 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin11.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin11.q.out
@@ -482,6 +482,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -870,6 +871,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin12.q.out b/ql/src/test/results/clientpositive/bucketmapjoin12.q.out
index bcd7394..575a9d1 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin12.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin12.q.out
@@ -347,6 +347,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -623,6 +624,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin13.q.out b/ql/src/test/results/clientpositive/bucketmapjoin13.q.out
index 7114721..f06f5a4 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin13.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin13.q.out
@@ -347,6 +347,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -627,6 +628,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -906,6 +908,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1187,6 +1190,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin7.q.out b/ql/src/test/results/clientpositive/bucketmapjoin7.q.out
index 667a9db..56b156e 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin7.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin7.q.out
@@ -331,6 +331,7 @@ STAGE PLANS:
                     columns.types int:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin8.q.out b/ql/src/test/results/clientpositive/bucketmapjoin8.q.out
index 252b377..426a3e8 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin8.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin8.q.out
@@ -313,6 +313,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -606,6 +607,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin9.q.out b/ql/src/test/results/clientpositive/bucketmapjoin9.q.out
index 5e28dc3..50ce9c9 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin9.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin9.q.out
@@ -313,6 +313,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -631,6 +632,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out b/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out
index 9a0bfc4..318c0dd 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out
@@ -269,6 +269,7 @@ STAGE PLANS:
                           columns.types string:string:string:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -458,6 +459,7 @@ STAGE PLANS:
                           columns.types string:string:string:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -636,6 +638,7 @@ STAGE PLANS:
                           columns.types string:string:string:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -817,6 +820,7 @@ STAGE PLANS:
                           columns.types string:string:string:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -998,6 +1002,7 @@ STAGE PLANS:
                           columns.types string:string:string:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1179,6 +1184,7 @@ STAGE PLANS:
                           columns.types string:string:string:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1360,6 +1366,7 @@ STAGE PLANS:
                           columns.types string:string:string:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1541,6 +1548,7 @@ STAGE PLANS:
                           columns.types string:string:string:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1722,6 +1730,7 @@ STAGE PLANS:
                           columns.types string:string:string:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/columnstats_partlvl.q.out b/ql/src/test/results/clientpositive/columnstats_partlvl.q.out
index a86c5fb..30cd5a3 100644
--- a/ql/src/test/results/clientpositive/columnstats_partlvl.q.out
+++ b/ql/src/test/results/clientpositive/columnstats_partlvl.q.out
@@ -205,6 +205,7 @@ STAGE PLANS:
                     columns.types struct<columntype:string,min:bigint,max:bigint,countnulls:bigint,numdistinctvalues:bigint>:double
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -405,6 +406,7 @@ STAGE PLANS:
                     columns.types struct<columntype:string,min:bigint,max:bigint,countnulls:bigint,numdistinctvalues:bigint>:double
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out b/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out
index 0ef04f5..e9cffa9 100644
--- a/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out
+++ b/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out
@@ -192,6 +192,7 @@ STAGE PLANS:
                   columns.types struct<columntype:string,maxlength:bigint,avglength:double,countnulls:bigint,numdistinctvalues:bigint>:struct<columntype:string,min:bigint,max:bigint,countnulls:bigint,numdistinctvalues:bigint>:struct<columntype:string,min:double,max:double,countnulls:bigint,numdistinctvalues:bigint>
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/combine2.q.out b/ql/src/test/results/clientpositive/combine2.q.out
index 865775a..36c59b4 100644
--- a/ql/src/test/results/clientpositive/combine2.q.out
+++ b/ql/src/test/results/clientpositive/combine2.q.out
@@ -594,6 +594,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/constantPropagateForSubQuery.q.out b/ql/src/test/results/clientpositive/constantPropagateForSubQuery.q.out
index 4ac2416..6d622d1 100644
--- a/ql/src/test/results/clientpositive/constantPropagateForSubQuery.q.out
+++ b/ql/src/test/results/clientpositive/constantPropagateForSubQuery.q.out
@@ -234,6 +234,7 @@ STAGE PLANS:
                     columns.types string:string:string:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out b/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out
index a176d9a..1e5c676 100644
--- a/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out
+++ b/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out
@@ -208,6 +208,7 @@ STAGE PLANS:
                   columns.types struct<columntype:string,maxlength:bigint,avglength:double,countnulls:bigint,numdistinctvalues:bigint>:struct<columntype:string,min:bigint,max:bigint,countnulls:bigint,numdistinctvalues:bigint>:struct<columntype:string,min:double,max:double,countnulls:bigint,numdistinctvalues:bigint>
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/encrypted/encryption_join_unencrypted_tbl.q.out b/ql/src/test/results/clientpositive/encrypted/encryption_join_unencrypted_tbl.q.out
index 9b6f750..57e978c 100644
--- a/ql/src/test/results/clientpositive/encrypted/encryption_join_unencrypted_tbl.q.out
+++ b/ql/src/test/results/clientpositive/encrypted/encryption_join_unencrypted_tbl.q.out
@@ -739,6 +739,7 @@ STAGE PLANS:
                       columns.types string:string:int:string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/encrypted/encryption_join_with_different_encryption_keys.q.out b/ql/src/test/results/clientpositive/encrypted/encryption_join_with_different_encryption_keys.q.out
index 40f6898..ceb7f9b 100644
--- a/ql/src/test/results/clientpositive/encrypted/encryption_join_with_different_encryption_keys.q.out
+++ b/ql/src/test/results/clientpositive/encrypted/encryption_join_with_different_encryption_keys.q.out
@@ -259,6 +259,7 @@ STAGE PLANS:
                       columns.types int:string:int:string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/escape_crlf.q.out b/ql/src/test/results/clientpositive/escape_crlf.q.out
new file mode 100644
index 0000000..3fc246a
--- /dev/null
+++ b/ql/src/test/results/clientpositive/escape_crlf.q.out
@@ -0,0 +1,98 @@
+PREHOOK: query: DROP TABLE IF EXISTS base_tab
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: DROP TABLE IF EXISTS base_tab
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: CREATE TABLE base_tab(a STRING, b STRING)
+ROW FORMAT DELIMITED
+    FIELDS TERMINATED BY '|'
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@base_tab
+POSTHOOK: query: CREATE TABLE base_tab(a STRING, b STRING)
+ROW FORMAT DELIMITED
+    FIELDS TERMINATED BY '|'
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@base_tab
+PREHOOK: query: DESCRIBE EXTENDED base_tab
+PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@base_tab
+POSTHOOK: query: DESCRIBE EXTENDED base_tab
+POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@base_tab
+a                   	string              	                    
+b                   	string              	                    
+	 	 
+#### A masked pattern was here ####
+PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/escape_crlf.txt' OVERWRITE INTO TABLE base_tab
+PREHOOK: type: LOAD
+#### A masked pattern was here ####
+PREHOOK: Output: default@base_tab
+POSTHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/escape_crlf.txt' OVERWRITE INTO TABLE base_tab
+POSTHOOK: type: LOAD
+#### A masked pattern was here ####
+POSTHOOK: Output: default@base_tab
+PREHOOK: query: -- No crlf escaping
+SELECT * FROM base_tab
+PREHOOK: type: QUERY
+PREHOOK: Input: default@base_tab
+#### A masked pattern was here ####
+POSTHOOK: query: -- No crlf escaping
+SELECT * FROM base_tab
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@base_tab
+#### A masked pattern was here ####
+This\nis\rthe first\r\nmulti-line field	field1-2
+This\nis\rthe second\r\nmulti-line field	field2-2
+PREHOOK: query: -- Crlf escaping
+ALTER TABLE base_tab SET SERDEPROPERTIES ('escape.delim'='\\', 'serialization.escape.crlf'='true')
+PREHOOK: type: ALTERTABLE_SERDEPROPERTIES
+PREHOOK: Input: default@base_tab
+PREHOOK: Output: default@base_tab
+POSTHOOK: query: -- Crlf escaping
+ALTER TABLE base_tab SET SERDEPROPERTIES ('escape.delim'='\\', 'serialization.escape.crlf'='true')
+POSTHOOK: type: ALTERTABLE_SERDEPROPERTIES
+POSTHOOK: Input: default@base_tab
+POSTHOOK: Output: default@base_tab
+PREHOOK: query: SELECT * FROM base_tab
+PREHOOK: type: QUERY
+PREHOOK: Input: default@base_tab
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT * FROM base_tab
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@base_tab
+#### A masked pattern was here ####
+This
+is
+the first
+multi-line field	field1-2
+This
+is
+the second
+multi-line field	field2-2
+PREHOOK: query: -- Make sure intermediate serde works correctly
+SELECT * FROM base_tab
+PREHOOK: type: QUERY
+PREHOOK: Input: default@base_tab
+#### A masked pattern was here ####
+POSTHOOK: query: -- Make sure intermediate serde works correctly
+SELECT * FROM base_tab
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@base_tab
+#### A masked pattern was here ####
+This
+is
+the first
+multi-line field	field1-2
+This
+is
+the second
+multi-line field	field2-2
+PREHOOK: query: DROP TABLE base_tab
+PREHOOK: type: DROPTABLE
+PREHOOK: Input: default@base_tab
+PREHOOK: Output: default@base_tab
+POSTHOOK: query: DROP TABLE base_tab
+POSTHOOK: type: DROPTABLE
+POSTHOOK: Input: default@base_tab
+POSTHOOK: Output: default@base_tab
diff --git a/ql/src/test/results/clientpositive/filter_join_breaktask.q.out b/ql/src/test/results/clientpositive/filter_join_breaktask.q.out
index 83f4720..c89df68 100644
--- a/ql/src/test/results/clientpositive/filter_join_breaktask.q.out
+++ b/ql/src/test/results/clientpositive/filter_join_breaktask.q.out
@@ -380,6 +380,7 @@ STAGE PLANS:
                     columns.types int:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out b/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out
index ee8cfa5..cdd2dca 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out
@@ -4151,6 +4151,7 @@ STAGE PLANS:
                   columns.types string:bigint:string:string:bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out b/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out
index 6a7f017..8a0d265 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out
@@ -4606,6 +4606,7 @@ STAGE PLANS:
                   columns.types string:bigint:string:string:bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/input23.q.out b/ql/src/test/results/clientpositive/input23.q.out
index 32b40cf..83a3ec3 100644
--- a/ql/src/test/results/clientpositive/input23.q.out
+++ b/ql/src/test/results/clientpositive/input23.q.out
@@ -162,6 +162,7 @@ STAGE PLANS:
                       columns.types string:string:string:string:string:string:string:string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/input_part7.q.out b/ql/src/test/results/clientpositive/input_part7.q.out
index f76a912..2ed8c2c 100644
--- a/ql/src/test/results/clientpositive/input_part7.q.out
+++ b/ql/src/test/results/clientpositive/input_part7.q.out
@@ -284,6 +284,7 @@ STAGE PLANS:
                   columns.types string:string:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/join_filters_overlap.q.out b/ql/src/test/results/clientpositive/join_filters_overlap.q.out
index 6ddd4b6..f52cf26 100644
--- a/ql/src/test/results/clientpositive/join_filters_overlap.q.out
+++ b/ql/src/test/results/clientpositive/join_filters_overlap.q.out
@@ -230,6 +230,7 @@ STAGE PLANS:
                     columns.types int:int:int:int:int:int
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -481,6 +482,7 @@ STAGE PLANS:
                     columns.types int:int:int:int:int:int
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -746,6 +748,7 @@ STAGE PLANS:
                     columns.types int:int:int:int:int:int
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1041,6 +1044,7 @@ STAGE PLANS:
                     columns.types int:int:int:int:int:int:int:int
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1330,6 +1334,7 @@ STAGE PLANS:
                     columns.types int:int:int:int:int:int:int:int
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_14.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_14.q.out
index 27dcb9e..d1e0019 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_14.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_14.q.out
@@ -310,6 +310,7 @@ STAGE PLANS:
                         columns.types string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_3.q.out b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_3.q.out
index 7c8df8b..899ee8a 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_3.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_3.q.out
@@ -480,6 +480,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_2.q.out b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_2.q.out
index 4f4f993..621cc6c 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_2.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_2.q.out
@@ -590,6 +590,7 @@ STAGE PLANS:
                   columns.types string:bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -782,6 +783,7 @@ STAGE PLANS:
                   columns.types int:bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/louter_join_ppr.q.out b/ql/src/test/results/clientpositive/louter_join_ppr.q.out
index 0f01afe..3af073a 100644
--- a/ql/src/test/results/clientpositive/louter_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/louter_join_ppr.q.out
@@ -328,6 +328,7 @@ STAGE PLANS:
                       columns.types string:string:string:string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -804,6 +805,7 @@ STAGE PLANS:
                       columns.types string:string:string:string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1181,6 +1183,7 @@ STAGE PLANS:
                     columns.types string:string:string:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1558,6 +1561,7 @@ STAGE PLANS:
                       columns.types string:string:string:string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/mapjoin_mapjoin.q.out b/ql/src/test/results/clientpositive/mapjoin_mapjoin.q.out
index 23b822e..7bdba82 100644
--- a/ql/src/test/results/clientpositive/mapjoin_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/mapjoin_mapjoin.q.out
@@ -160,6 +160,7 @@ STAGE PLANS:
                               columns.types string
                               escape.delim \
                               hive.serialization.extend.additional.nesting.levels true
+                              serialization.escape.crlf true
                               serialization.format 1
                               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/metadataonly1.q.out b/ql/src/test/results/clientpositive/metadataonly1.q.out
index b241c2e..452bc55 100644
--- a/ql/src/test/results/clientpositive/metadataonly1.q.out
+++ b/ql/src/test/results/clientpositive/metadataonly1.q.out
@@ -58,6 +58,7 @@ STAGE PLANS:
                   columns.types string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -203,6 +204,7 @@ STAGE PLANS:
                   columns.types string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -344,6 +346,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -485,6 +488,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -935,6 +939,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1200,6 +1205,7 @@ STAGE PLANS:
                   columns.types string:bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1440,6 +1446,7 @@ STAGE PLANS:
                   columns.types string:bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1624,6 +1631,7 @@ STAGE PLANS:
                   columns.types string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1995,6 +2003,7 @@ STAGE PLANS:
                   columns.types string:bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/optimize_nullscan.q.out b/ql/src/test/results/clientpositive/optimize_nullscan.q.out
index 4e16e82..75a57db 100644
--- a/ql/src/test/results/clientpositive/optimize_nullscan.q.out
+++ b/ql/src/test/results/clientpositive/optimize_nullscan.q.out
@@ -68,6 +68,7 @@ STAGE PLANS:
                         columns.types string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -203,6 +204,7 @@ STAGE PLANS:
                     columns.types bigint
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -657,6 +659,7 @@ STAGE PLANS:
                   columns.types string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -866,6 +869,7 @@ STAGE PLANS:
                       columns.types bigint
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -891,6 +895,7 @@ STAGE PLANS:
                       columns.types bigint
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1631,6 +1636,7 @@ STAGE PLANS:
                   columns.types string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1850,6 +1856,7 @@ STAGE PLANS:
                       columns.types string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1885,6 +1892,7 @@ STAGE PLANS:
                           columns.types string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2135,6 +2143,7 @@ STAGE PLANS:
                     columns.types string:string:string:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2281,6 +2290,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/outer_join_ppr.q.java1.7.out b/ql/src/test/results/clientpositive/outer_join_ppr.q.java1.7.out
index b6ca16f..3e78832 100644
--- a/ql/src/test/results/clientpositive/outer_join_ppr.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/outer_join_ppr.q.java1.7.out
@@ -421,6 +421,7 @@ STAGE PLANS:
                       columns.types string:string:string:string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -802,6 +803,7 @@ STAGE PLANS:
                       columns.types string:string:string:string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/pcr.q.out b/ql/src/test/results/clientpositive/pcr.q.out
index d300a5f..1a54dbc 100644
--- a/ql/src/test/results/clientpositive/pcr.q.out
+++ b/ql/src/test/results/clientpositive/pcr.q.out
@@ -236,6 +236,7 @@ STAGE PLANS:
                   columns.types int:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -499,6 +500,7 @@ STAGE PLANS:
                   columns.types int:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -764,6 +766,7 @@ STAGE PLANS:
                   columns.types int:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -999,6 +1002,7 @@ STAGE PLANS:
                   columns.types int:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1282,6 +1286,7 @@ STAGE PLANS:
                   columns.types int:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1575,6 +1580,7 @@ STAGE PLANS:
                   columns.types int:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1821,6 +1827,7 @@ STAGE PLANS:
                   columns.types int:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2026,6 +2033,7 @@ STAGE PLANS:
                   columns.types int:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2317,6 +2325,7 @@ STAGE PLANS:
                   columns.types int:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2604,6 +2613,7 @@ STAGE PLANS:
                   columns.types int:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2866,6 +2876,7 @@ STAGE PLANS:
                   columns.types int:string:string:int:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3209,6 +3220,7 @@ STAGE PLANS:
                   columns.types int:string:string:int:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3579,6 +3591,7 @@ STAGE PLANS:
                   columns.types int:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3896,6 +3909,7 @@ STAGE PLANS:
                   columns.types int:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -5350,6 +5364,7 @@ STAGE PLANS:
                     columns.types string:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -5577,6 +5592,7 @@ STAGE PLANS:
                   columns.types string:string:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -5800,6 +5816,7 @@ STAGE PLANS:
                   columns.types string:string:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/ppd_join_filter.q.out b/ql/src/test/results/clientpositive/ppd_join_filter.q.out
index e1a188f..c26ee2c 100644
--- a/ql/src/test/results/clientpositive/ppd_join_filter.q.out
+++ b/ql/src/test/results/clientpositive/ppd_join_filter.q.out
@@ -376,6 +376,7 @@ STAGE PLANS:
                     columns.types string:double:double
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -793,6 +794,7 @@ STAGE PLANS:
                     columns.types string:double:double
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1210,6 +1212,7 @@ STAGE PLANS:
                     columns.types string:double:double
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1627,6 +1630,7 @@ STAGE PLANS:
                     columns.types string:double:double
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/ppd_union_view.q.out b/ql/src/test/results/clientpositive/ppd_union_view.q.out
index 40970e7..ce266f9 100644
--- a/ql/src/test/results/clientpositive/ppd_union_view.q.out
+++ b/ql/src/test/results/clientpositive/ppd_union_view.q.out
@@ -354,6 +354,7 @@ STAGE PLANS:
                         columns.types string:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -525,6 +526,7 @@ STAGE PLANS:
                         columns.types string:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -550,6 +552,7 @@ STAGE PLANS:
                       columns.types string:string:string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/ppd_vc.q.out b/ql/src/test/results/clientpositive/ppd_vc.q.out
index 7e3953b..9e1994b 100644
--- a/ql/src/test/results/clientpositive/ppd_vc.q.out
+++ b/ql/src/test/results/clientpositive/ppd_vc.q.out
@@ -64,6 +64,7 @@ STAGE PLANS:
                         columns.types string:string:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -774,6 +775,7 @@ STAGE PLANS:
                   columns.types string:string:string:string:bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/ppr_allchildsarenull.q.out b/ql/src/test/results/clientpositive/ppr_allchildsarenull.q.out
index 0cb48be..39ab726 100644
--- a/ql/src/test/results/clientpositive/ppr_allchildsarenull.q.out
+++ b/ql/src/test/results/clientpositive/ppr_allchildsarenull.q.out
@@ -95,6 +95,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -327,6 +328,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/push_or.q.out b/ql/src/test/results/clientpositive/push_or.q.out
index 28446c5..c8edb65 100644
--- a/ql/src/test/results/clientpositive/push_or.q.out
+++ b/ql/src/test/results/clientpositive/push_or.q.out
@@ -218,6 +218,7 @@ STAGE PLANS:
                   columns.types int:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/query_result_fileformat.q.out b/ql/src/test/results/clientpositive/query_result_fileformat.q.out
index 71a50dd..93b98df 100644
--- a/ql/src/test/results/clientpositive/query_result_fileformat.q.out
+++ b/ql/src/test/results/clientpositive/query_result_fileformat.q.out
@@ -82,9 +82,9 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@nzhang_test1
 #### A masked pattern was here ####
 key1	value
-1	NULL
-	NULL
-http://asdf	NULL
+1
+
+http://asdf
 PREHOOK: query: select * from nzhang_test1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@nzhang_test1
diff --git a/ql/src/test/results/clientpositive/rand_partitionpruner1.q.out b/ql/src/test/results/clientpositive/rand_partitionpruner1.q.out
index 90f17a7..3d8e9b8 100644
--- a/ql/src/test/results/clientpositive/rand_partitionpruner1.q.out
+++ b/ql/src/test/results/clientpositive/rand_partitionpruner1.q.out
@@ -61,6 +61,7 @@ STAGE PLANS:
                         columns.types string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/regexp_extract.q.out b/ql/src/test/results/clientpositive/regexp_extract.q.out
index 84bae16..f69f831 100644
--- a/ql/src/test/results/clientpositive/regexp_extract.q.out
+++ b/ql/src/test/results/clientpositive/regexp_extract.q.out
@@ -197,6 +197,7 @@ STAGE PLANS:
                   columns.types string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -512,6 +513,7 @@ STAGE PLANS:
                   columns.types string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/remote_script.q.out b/ql/src/test/results/clientpositive/remote_script.q.out
index 6ec9949..87531f0 100644
--- a/ql/src/test/results/clientpositive/remote_script.q.out
+++ b/ql/src/test/results/clientpositive/remote_script.q.out
@@ -30,13 +30,13 @@ POSTHOOK: Input: default@tmp_tmp
 #### A masked pattern was here ####
 1	2	NULL
 1	2	NULL
-1	NULL
+1
 2	NULL
-1	NULL
+1
 2	NULL
-1	NULL
+1
 2	NULL
-1	NULL
+1
 2	NULL
 #### A masked pattern was here ####
 PREHOOK: query: drop table tmp_tmp
diff --git a/ql/src/test/results/clientpositive/router_join_ppr.q.out b/ql/src/test/results/clientpositive/router_join_ppr.q.out
index 70d7542..b4f4016 100644
--- a/ql/src/test/results/clientpositive/router_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/router_join_ppr.q.out
@@ -427,6 +427,7 @@ STAGE PLANS:
                       columns.types string:string:string:string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -808,6 +809,7 @@ STAGE PLANS:
                       columns.types string:string:string:string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1185,6 +1187,7 @@ STAGE PLANS:
                       columns.types string:string:string:string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1558,6 +1561,7 @@ STAGE PLANS:
                     columns.types string:string:string:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/sample10.q.out b/ql/src/test/results/clientpositive/sample10.q.out
index 6495fb8..ee248df 100644
--- a/ql/src/test/results/clientpositive/sample10.q.out
+++ b/ql/src/test/results/clientpositive/sample10.q.out
@@ -400,6 +400,7 @@ STAGE PLANS:
                   columns.types string:bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/sample6.q.out b/ql/src/test/results/clientpositive/sample6.q.out
index 9241ce0..a18729f 100644
--- a/ql/src/test/results/clientpositive/sample6.q.out
+++ b/ql/src/test/results/clientpositive/sample6.q.out
@@ -728,6 +728,7 @@ STAGE PLANS:
                   columns.types int:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1125,6 +1126,7 @@ STAGE PLANS:
                   columns.types int:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1776,6 +1778,7 @@ STAGE PLANS:
                   columns.types int:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2270,6 +2273,7 @@ STAGE PLANS:
                   columns.types int:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2797,6 +2801,7 @@ STAGE PLANS:
                   columns.types int:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3077,6 +3082,7 @@ STAGE PLANS:
                   columns.types int:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3211,6 +3217,7 @@ STAGE PLANS:
                   columns.types int:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/sample8.q.out b/ql/src/test/results/clientpositive/sample8.q.out
index 3f3d3bc..7801edf 100644
--- a/ql/src/test/results/clientpositive/sample8.q.out
+++ b/ql/src/test/results/clientpositive/sample8.q.out
@@ -347,6 +347,7 @@ STAGE PLANS:
                       columns.types string:string:string:string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/sample9.q.out b/ql/src/test/results/clientpositive/sample9.q.out
index a8c2e82..ef9d01e 100644
--- a/ql/src/test/results/clientpositive/sample9.q.out
+++ b/ql/src/test/results/clientpositive/sample9.q.out
@@ -78,6 +78,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/serde_user_properties.q.out b/ql/src/test/results/clientpositive/serde_user_properties.q.out
index ac3c135..82a43ae 100644
--- a/ql/src/test/results/clientpositive/serde_user_properties.q.out
+++ b/ql/src/test/results/clientpositive/serde_user_properties.q.out
@@ -141,6 +141,7 @@ STAGE PLANS:
                       columns.types string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -311,6 +312,7 @@ STAGE PLANS:
                       columns.types string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -489,6 +491,7 @@ STAGE PLANS:
                       columns.types string
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out
index 056c9f1..f29ec4c 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out
@@ -1883,6 +1883,7 @@ STAGE PLANS:
                         columns.types int:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2007,6 +2008,7 @@ STAGE PLANS:
                         columns.types int:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
index bd28bbb..38457b2 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
@@ -227,6 +227,7 @@ STAGE PLANS:
                     columns.types int:string:int:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -452,6 +453,7 @@ STAGE PLANS:
                     columns.types int:string:int:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out
index 2b6a62e..d3b2940 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out
@@ -199,6 +199,7 @@ STAGE PLANS:
                     columns.types int:string:int:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -455,6 +456,7 @@ STAGE PLANS:
                     columns.types int:int:string:int:int:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -659,6 +661,7 @@ STAGE PLANS:
                     columns.types int:int:string:int:int:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -902,6 +905,7 @@ STAGE PLANS:
                     columns.types int:int:string:int:int:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out
index 13cfb1a..74877a4 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out
@@ -216,6 +216,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_6.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_6.q.out
index d5ae55e..aa4e1bf 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_6.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_6.q.out
@@ -300,6 +300,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out
index c4aa11b..863a4d1 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out
@@ -420,6 +420,7 @@ STAGE PLANS:
                   columns.types bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/auto_join_reordering_values.q.out b/ql/src/test/results/clientpositive/spark/auto_join_reordering_values.q.out
index 7b9a98d..9df55b9 100644
--- a/ql/src/test/results/clientpositive/spark/auto_join_reordering_values.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_join_reordering_values.q.out
@@ -602,6 +602,7 @@ STAGE PLANS:
                             columns.types string:int
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out
index 3177b2f..cffe05b 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out
@@ -306,6 +306,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -537,6 +538,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -859,6 +861,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_12.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_12.q.out
index a70b161..197b132 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_12.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_12.q.out
@@ -611,6 +611,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_2.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_2.q.out
index e528a1a..4b08411 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_2.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_2.q.out
@@ -286,6 +286,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -610,6 +611,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out
index f4d9b06..23a920c 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out
@@ -237,6 +237,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -419,6 +420,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -741,6 +743,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out
index 2423eec..3e9e3fd 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out
@@ -253,6 +253,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -435,6 +436,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -757,6 +759,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
index 732beb5..34bd6d0 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
@@ -214,6 +214,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -386,6 +387,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -645,6 +647,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out
index ff9b8e4..2f19dec 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out
@@ -319,6 +319,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -552,6 +553,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -925,6 +927,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out
index 05b63c2..f950dda 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out
@@ -319,6 +319,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -552,6 +553,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -927,6 +929,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_1.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_1.q.out
index 7570ebe..d3f433d 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_1.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_1.q.out
@@ -299,6 +299,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_2.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_2.q.out
index 80b44e9..3d850db 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_2.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_2.q.out
@@ -299,6 +299,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark4.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark4.q.out
index 174d7b2..be46c92 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark4.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark4.q.out
@@ -349,6 +349,7 @@ STAGE PLANS:
                                   columns.types int:string:string:string
                                   escape.delim \
                                   hive.serialization.extend.additional.nesting.levels true
+                                  serialization.escape.crlf true
                                   serialization.format 1
                                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -775,6 +776,7 @@ STAGE PLANS:
                                   columns.types int:string:string:string
                                   escape.delim \
                                   hive.serialization.extend.additional.nesting.levels true
+                                  serialization.escape.crlf true
                                   serialization.format 1
                                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin10.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin10.q.out
index 678ad54..d7d7d40 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin10.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin10.q.out
@@ -481,6 +481,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin11.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin11.q.out
index 95606f0..dfdff5c 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin11.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin11.q.out
@@ -502,6 +502,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -910,6 +911,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin12.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin12.q.out
index d6c25e4..07f3c15 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin12.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin12.q.out
@@ -364,6 +364,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -654,6 +655,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin13.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin13.q.out
index 14cdda2..1d6e64c 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin13.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin13.q.out
@@ -361,6 +361,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -658,6 +659,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -954,6 +956,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1252,6 +1255,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin7.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin7.q.out
index 7bfe440..a99cb74 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin7.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin7.q.out
@@ -348,6 +348,7 @@ STAGE PLANS:
                           columns.types int:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin8.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin8.q.out
index 4601eb1..d6c42b5 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin8.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin8.q.out
@@ -330,6 +330,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -640,6 +641,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin9.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin9.q.out
index 60bd103..e65e689 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin9.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin9.q.out
@@ -327,6 +327,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -659,6 +660,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative3.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative3.q.out
index a09904e..3671564 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative3.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative3.q.out
@@ -321,6 +321,7 @@ STAGE PLANS:
                                 columns.types string:string:string:string
                                 escape.delim \
                                 hive.serialization.extend.additional.nesting.levels true
+                                serialization.escape.crlf true
                                 serialization.format 1
                                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -567,6 +568,7 @@ STAGE PLANS:
                                 columns.types string:string:string:string
                                 escape.delim \
                                 hive.serialization.extend.additional.nesting.levels true
+                                serialization.escape.crlf true
                                 serialization.format 1
                                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -804,6 +806,7 @@ STAGE PLANS:
                                 columns.types string:string:string:string
                                 escape.delim \
                                 hive.serialization.extend.additional.nesting.levels true
+                                serialization.escape.crlf true
                                 serialization.format 1
                                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1039,6 +1042,7 @@ STAGE PLANS:
                                 columns.types string:string:string:string
                                 escape.delim \
                                 hive.serialization.extend.additional.nesting.levels true
+                                serialization.escape.crlf true
                                 serialization.format 1
                                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1274,6 +1278,7 @@ STAGE PLANS:
                                 columns.types string:string:string:string
                                 escape.delim \
                                 hive.serialization.extend.additional.nesting.levels true
+                                serialization.escape.crlf true
                                 serialization.format 1
                                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1509,6 +1514,7 @@ STAGE PLANS:
                                 columns.types string:string:string:string
                                 escape.delim \
                                 hive.serialization.extend.additional.nesting.levels true
+                                serialization.escape.crlf true
                                 serialization.format 1
                                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1744,6 +1750,7 @@ STAGE PLANS:
                                 columns.types string:string:string:string
                                 escape.delim \
                                 hive.serialization.extend.additional.nesting.levels true
+                                serialization.escape.crlf true
                                 serialization.format 1
                                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1979,6 +1986,7 @@ STAGE PLANS:
                                 columns.types string:string:string:string
                                 escape.delim \
                                 hive.serialization.extend.additional.nesting.levels true
+                                serialization.escape.crlf true
                                 serialization.format 1
                                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2214,6 +2222,7 @@ STAGE PLANS:
                                 columns.types string:string:string:string
                                 escape.delim \
                                 hive.serialization.extend.additional.nesting.levels true
+                                serialization.escape.crlf true
                                 serialization.format 1
                                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/filter_join_breaktask.q.out b/ql/src/test/results/clientpositive/spark/filter_join_breaktask.q.out
index 7c3c581..216e43b 100644
--- a/ql/src/test/results/clientpositive/spark/filter_join_breaktask.q.out
+++ b/ql/src/test/results/clientpositive/spark/filter_join_breaktask.q.out
@@ -397,6 +397,7 @@ STAGE PLANS:
                           columns.types int:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out b/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out
index 77a9739..6474ec6 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out
@@ -3279,6 +3279,7 @@ STAGE PLANS:
                         columns.types string:bigint:string:string:bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out b/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out
index fc923de..edda01e 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out
@@ -3370,6 +3370,7 @@ STAGE PLANS:
                         columns.types string:bigint:string:string:bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/join_filters_overlap.q.out b/ql/src/test/results/clientpositive/spark/join_filters_overlap.q.out
index 7b527e2..0f9d1ae 100644
--- a/ql/src/test/results/clientpositive/spark/join_filters_overlap.q.out
+++ b/ql/src/test/results/clientpositive/spark/join_filters_overlap.q.out
@@ -338,6 +338,7 @@ STAGE PLANS:
                           columns.types int:int:int:int:int:int
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -697,6 +698,7 @@ STAGE PLANS:
                           columns.types int:int:int:int:int:int
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1070,6 +1072,7 @@ STAGE PLANS:
                           columns.types int:int:int:int:int:int
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1524,6 +1527,7 @@ STAGE PLANS:
                           columns.types int:int:int:int:int:int:int:int
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1972,6 +1976,7 @@ STAGE PLANS:
                           columns.types int:int:int:int:int:int:int:int
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/louter_join_ppr.q.out b/ql/src/test/results/clientpositive/spark/louter_join_ppr.q.out
index 78cd4bc..0db822f 100644
--- a/ql/src/test/results/clientpositive/spark/louter_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/louter_join_ppr.q.out
@@ -332,6 +332,7 @@ STAGE PLANS:
                             columns.types string:string:string:string
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -812,6 +813,7 @@ STAGE PLANS:
                             columns.types string:string:string:string
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1291,6 +1293,7 @@ STAGE PLANS:
                             columns.types string:string:string:string
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1676,6 +1679,7 @@ STAGE PLANS:
                             columns.types string:string:string:string
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/mapjoin_mapjoin.q.out b/ql/src/test/results/clientpositive/spark/mapjoin_mapjoin.q.out
index 7089004..8ec2e95 100644
--- a/ql/src/test/results/clientpositive/spark/mapjoin_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/spark/mapjoin_mapjoin.q.out
@@ -265,6 +265,7 @@ STAGE PLANS:
                                     columns.types string
                                     escape.delim \
                                     hive.serialization.extend.additional.nesting.levels true
+                                    serialization.escape.crlf true
                                     serialization.format 1
                                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/optimize_nullscan.q.out b/ql/src/test/results/clientpositive/spark/optimize_nullscan.q.out
index f8f5ae1..8d90398 100644
--- a/ql/src/test/results/clientpositive/spark/optimize_nullscan.q.out
+++ b/ql/src/test/results/clientpositive/spark/optimize_nullscan.q.out
@@ -135,6 +135,7 @@ STAGE PLANS:
                           columns.types bigint
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -536,6 +537,7 @@ STAGE PLANS:
                         columns.types string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -955,6 +957,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -984,6 +987,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1388,6 +1392,7 @@ STAGE PLANS:
                         columns.types string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1541,6 +1546,7 @@ STAGE PLANS:
                               columns.types string
                               escape.delim \
                               hive.serialization.extend.additional.nesting.levels true
+                              serialization.escape.crlf true
                               serialization.format 1
                               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1685,6 +1691,7 @@ STAGE PLANS:
                         columns.types string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1921,6 +1928,7 @@ STAGE PLANS:
                           columns.types string:string:string:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2073,6 +2081,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/outer_join_ppr.q.java1.7.out b/ql/src/test/results/clientpositive/spark/outer_join_ppr.q.java1.7.out
index 227886b..ac59641 100644
--- a/ql/src/test/results/clientpositive/spark/outer_join_ppr.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/spark/outer_join_ppr.q.java1.7.out
@@ -425,6 +425,7 @@ STAGE PLANS:
                             columns.types string:string:string:string
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -896,6 +897,7 @@ STAGE PLANS:
                             columns.types string:string:string:string
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/pcr.q.out b/ql/src/test/results/clientpositive/spark/pcr.q.out
index 4c22f0b..d6b1380 100644
--- a/ql/src/test/results/clientpositive/spark/pcr.q.out
+++ b/ql/src/test/results/clientpositive/spark/pcr.q.out
@@ -242,6 +242,7 @@ STAGE PLANS:
                         columns.types int:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -511,6 +512,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -782,6 +784,7 @@ STAGE PLANS:
                         columns.types int:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1023,6 +1026,7 @@ STAGE PLANS:
                         columns.types int:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1312,6 +1316,7 @@ STAGE PLANS:
                         columns.types int:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1611,6 +1616,7 @@ STAGE PLANS:
                         columns.types int:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1863,6 +1869,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2074,6 +2081,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2371,6 +2379,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2664,6 +2673,7 @@ STAGE PLANS:
                         columns.types int:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2937,6 +2947,7 @@ STAGE PLANS:
                         columns.types int:string:string:int:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3245,6 +3256,7 @@ STAGE PLANS:
                         columns.types int:string:string:int:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3621,6 +3633,7 @@ STAGE PLANS:
                         columns.types int:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3944,6 +3957,7 @@ STAGE PLANS:
                         columns.types int:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -4718,6 +4732,7 @@ STAGE PLANS:
                           columns.types string:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -4951,6 +4966,7 @@ STAGE PLANS:
                         columns.types string:string:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -5180,6 +5196,7 @@ STAGE PLANS:
                         columns.types string:string:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/ppd_join_filter.q.out b/ql/src/test/results/clientpositive/spark/ppd_join_filter.q.out
index 0cbd718..0997cb9 100644
--- a/ql/src/test/results/clientpositive/spark/ppd_join_filter.q.out
+++ b/ql/src/test/results/clientpositive/spark/ppd_join_filter.q.out
@@ -325,6 +325,7 @@ STAGE PLANS:
                           columns.types string:double:double
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -699,6 +700,7 @@ STAGE PLANS:
                           columns.types string:double:double
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1073,6 +1075,7 @@ STAGE PLANS:
                           columns.types string:double:double
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1447,6 +1450,7 @@ STAGE PLANS:
                           columns.types string:double:double
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/remote_script.q.out b/ql/src/test/results/clientpositive/spark/remote_script.q.out
index 6ec9949..87531f0 100644
--- a/ql/src/test/results/clientpositive/spark/remote_script.q.out
+++ b/ql/src/test/results/clientpositive/spark/remote_script.q.out
@@ -30,13 +30,13 @@ POSTHOOK: Input: default@tmp_tmp
 #### A masked pattern was here ####
 1	2	NULL
 1	2	NULL
-1	NULL
+1
 2	NULL
-1	NULL
+1
 2	NULL
-1	NULL
+1
 2	NULL
-1	NULL
+1
 2	NULL
 #### A masked pattern was here ####
 PREHOOK: query: drop table tmp_tmp
diff --git a/ql/src/test/results/clientpositive/spark/router_join_ppr.q.out b/ql/src/test/results/clientpositive/spark/router_join_ppr.q.out
index 36af99a..5ced6f3 100644
--- a/ql/src/test/results/clientpositive/spark/router_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/router_join_ppr.q.out
@@ -431,6 +431,7 @@ STAGE PLANS:
                             columns.types string:string:string:string
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -816,6 +817,7 @@ STAGE PLANS:
                             columns.types string:string:string:string
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1197,6 +1199,7 @@ STAGE PLANS:
                             columns.types string:string:string:string
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1672,6 +1675,7 @@ STAGE PLANS:
                             columns.types string:string:string:string
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/sample10.q.out b/ql/src/test/results/clientpositive/spark/sample10.q.out
index b63718b..f103ed8 100644
--- a/ql/src/test/results/clientpositive/spark/sample10.q.out
+++ b/ql/src/test/results/clientpositive/spark/sample10.q.out
@@ -359,6 +359,7 @@ STAGE PLANS:
                         columns.types string:bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/sample6.q.out b/ql/src/test/results/clientpositive/spark/sample6.q.out
index 80fda3c..277ef9a 100644
--- a/ql/src/test/results/clientpositive/spark/sample6.q.out
+++ b/ql/src/test/results/clientpositive/spark/sample6.q.out
@@ -579,6 +579,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -982,6 +983,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1639,6 +1641,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2139,6 +2142,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2672,6 +2676,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2958,6 +2963,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3098,6 +3104,7 @@ STAGE PLANS:
                         columns.types int:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/sample8.q.out b/ql/src/test/results/clientpositive/spark/sample8.q.out
index 65fab26..bc1b934 100644
--- a/ql/src/test/results/clientpositive/spark/sample8.q.out
+++ b/ql/src/test/results/clientpositive/spark/sample8.q.out
@@ -406,6 +406,7 @@ STAGE PLANS:
                             columns.types string:string:string:string
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out b/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out
index 7786da1..00ce981 100644
--- a/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out
+++ b/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out
@@ -239,6 +239,7 @@ STAGE PLANS:
                           columns.types int:string:int:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -525,6 +526,7 @@ STAGE PLANS:
                           columns.types int:string:int:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out b/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out
index 70e3077..ad12d5f 100644
--- a/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out
+++ b/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out
@@ -211,6 +211,7 @@ STAGE PLANS:
                           columns.types int:string:int:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -479,6 +480,7 @@ STAGE PLANS:
                           columns.types int:int:string:int:int:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -695,6 +697,7 @@ STAGE PLANS:
                           columns.types int:int:string:int:int:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1002,6 +1005,7 @@ STAGE PLANS:
                           columns.types int:int:string:int:int:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/transform_ppr1.q.out b/ql/src/test/results/clientpositive/spark/transform_ppr1.q.out
index 994d14e..6c649dd 100644
--- a/ql/src/test/results/clientpositive/spark/transform_ppr1.q.out
+++ b/ql/src/test/results/clientpositive/spark/transform_ppr1.q.out
@@ -355,6 +355,7 @@ STAGE PLANS:
                         columns.types string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/transform_ppr2.q.out b/ql/src/test/results/clientpositive/spark/transform_ppr2.q.out
index de5162d..eeb5087 100644
--- a/ql/src/test/results/clientpositive/spark/transform_ppr2.q.out
+++ b/ql/src/test/results/clientpositive/spark/transform_ppr2.q.out
@@ -263,6 +263,7 @@ STAGE PLANS:
                         columns.types string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/union_ppr.q.out b/ql/src/test/results/clientpositive/spark/union_ppr.q.out
index 959a521..c95d8a1 100644
--- a/ql/src/test/results/clientpositive/spark/union_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/union_ppr.q.out
@@ -385,6 +385,7 @@ STAGE PLANS:
                         columns.types string:string:string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/spark/vectorized_ptf.q.out b/ql/src/test/results/clientpositive/spark/vectorized_ptf.q.out
index f48b27d..03ce658 100644
--- a/ql/src/test/results/clientpositive/spark/vectorized_ptf.q.out
+++ b/ql/src/test/results/clientpositive/spark/vectorized_ptf.q.out
@@ -339,6 +339,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -714,6 +715,7 @@ STAGE PLANS:
                             columns.types string:string:int:int
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -921,6 +923,7 @@ STAGE PLANS:
                             columns.types string:string:int
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1196,6 +1199,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1483,6 +1487,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:int:int
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1805,6 +1810,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:int:int
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2116,6 +2122,7 @@ STAGE PLANS:
                         columns.types int:string:string:string:string:int:string:double:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2407,6 +2414,7 @@ STAGE PLANS:
                           columns.types int:string:string:string:string:int:string:double:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2672,6 +2680,7 @@ STAGE PLANS:
                             columns.types string:string:int:int
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2947,6 +2956,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3225,6 +3235,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3530,6 +3541,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3838,6 +3850,7 @@ STAGE PLANS:
                             columns.types string:string:bigint:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -4313,6 +4326,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:bigint:double:double:int:int
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -4551,6 +4565,7 @@ STAGE PLANS:
                         columns.types string:string:int
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -4845,6 +4860,7 @@ STAGE PLANS:
                             columns.types string:string:double:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -5826,6 +5842,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:bigint
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -6195,6 +6212,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:bigint
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -6532,6 +6550,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:bigint
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -6898,6 +6917,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:bigint
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -7280,6 +7300,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:bigint:bigint
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -7628,6 +7649,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:bigint:bigint
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/temp_table_display_colstats_tbllvl.q.out b/ql/src/test/results/clientpositive/temp_table_display_colstats_tbllvl.q.out
index 933d24b..28fc0f4 100644
--- a/ql/src/test/results/clientpositive/temp_table_display_colstats_tbllvl.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_display_colstats_tbllvl.q.out
@@ -216,6 +216,7 @@ STAGE PLANS:
                   columns.types struct<columntype:string,maxlength:bigint,avglength:double,countnulls:bigint,numdistinctvalues:bigint>:struct<columntype:string,min:bigint,max:bigint,countnulls:bigint,numdistinctvalues:bigint>:struct<columntype:string,min:double,max:double,countnulls:bigint,numdistinctvalues:bigint>
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_1.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_1.q.out
index f05295e..63c5d32 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_1.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_1.q.out
@@ -380,6 +380,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -685,6 +686,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -990,6 +992,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_11.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_11.q.out
index a555700..5814229 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_11.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_11.q.out
@@ -373,6 +373,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -683,6 +684,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -992,6 +994,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1436,6 +1439,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_12.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_12.q.out
index 5ba3767..9a375f9 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_12.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_12.q.out
@@ -600,6 +600,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_2.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_2.q.out
index 7997c4d..07ba97b 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_2.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_2.q.out
@@ -360,6 +360,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -667,6 +668,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_3.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_3.q.out
index d6ed0c5..cdd8137 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_3.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_3.q.out
@@ -360,6 +360,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -665,6 +666,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -970,6 +972,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_4.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_4.q.out
index 5fb23bb..241c561 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_4.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_4.q.out
@@ -376,6 +376,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -681,6 +682,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -986,6 +988,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out
index e285b28..0be3a23 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out
@@ -270,6 +270,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -498,6 +499,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -740,6 +742,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_7.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_7.q.out
index 5f8eacf..40e1a9b 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_7.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_7.q.out
@@ -442,6 +442,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -798,6 +799,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1154,6 +1156,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_8.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_8.q.out
index 92eef8f..5f7846c 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_8.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_8.q.out
@@ -442,6 +442,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -798,6 +799,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1156,6 +1158,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/filter_join_breaktask.q.out b/ql/src/test/results/clientpositive/tez/filter_join_breaktask.q.out
index 06f1ca4..441710b 100644
--- a/ql/src/test/results/clientpositive/tez/filter_join_breaktask.q.out
+++ b/ql/src/test/results/clientpositive/tez/filter_join_breaktask.q.out
@@ -399,6 +399,7 @@ STAGE PLANS:
                           columns.types int:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/mapjoin_mapjoin.q.out b/ql/src/test/results/clientpositive/tez/mapjoin_mapjoin.q.out
index fb34588..b00a3e0 100644
--- a/ql/src/test/results/clientpositive/tez/mapjoin_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/mapjoin_mapjoin.q.out
@@ -193,6 +193,7 @@ STAGE PLANS:
                                     columns.types string
                                     escape.delim \
                                     hive.serialization.extend.additional.nesting.levels true
+                                    serialization.escape.crlf true
                                     serialization.format 1
                                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/metadataonly1.q.out b/ql/src/test/results/clientpositive/tez/metadataonly1.q.out
index cd33eaf..98583da 100644
--- a/ql/src/test/results/clientpositive/tez/metadataonly1.q.out
+++ b/ql/src/test/results/clientpositive/tez/metadataonly1.q.out
@@ -87,6 +87,7 @@ STAGE PLANS:
                         columns.types string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -238,6 +239,7 @@ STAGE PLANS:
                         columns.types string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -385,6 +387,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -532,6 +535,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -883,6 +887,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1188,6 +1193,7 @@ STAGE PLANS:
                         columns.types string:bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1434,6 +1440,7 @@ STAGE PLANS:
                         columns.types string:bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1624,6 +1631,7 @@ STAGE PLANS:
                         columns.types string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2001,6 +2009,7 @@ STAGE PLANS:
                         columns.types string:bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/optimize_nullscan.q.out b/ql/src/test/results/clientpositive/tez/optimize_nullscan.q.out
index eed5ef8..5f4fcfb 100644
--- a/ql/src/test/results/clientpositive/tez/optimize_nullscan.q.out
+++ b/ql/src/test/results/clientpositive/tez/optimize_nullscan.q.out
@@ -158,6 +158,7 @@ STAGE PLANS:
                           columns.types bigint
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -560,6 +561,7 @@ STAGE PLANS:
                         columns.types string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -979,6 +981,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1008,6 +1011,7 @@ STAGE PLANS:
                         columns.types bigint
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1415,6 +1419,7 @@ STAGE PLANS:
                         columns.types string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1569,6 +1574,7 @@ STAGE PLANS:
                               columns.types string
                               escape.delim \
                               hive.serialization.extend.additional.nesting.levels true
+                              serialization.escape.crlf true
                               serialization.format 1
                               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1736,6 +1742,7 @@ STAGE PLANS:
                         columns.types string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1975,6 +1982,7 @@ STAGE PLANS:
                           columns.types string:string:string:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/transform_ppr1.q.out b/ql/src/test/results/clientpositive/tez/transform_ppr1.q.out
index f2d3943..88c273b 100644
--- a/ql/src/test/results/clientpositive/tez/transform_ppr1.q.out
+++ b/ql/src/test/results/clientpositive/tez/transform_ppr1.q.out
@@ -355,6 +355,7 @@ STAGE PLANS:
                         columns.types string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/transform_ppr2.q.out b/ql/src/test/results/clientpositive/tez/transform_ppr2.q.out
index 02187fe..04fa2f9 100644
--- a/ql/src/test/results/clientpositive/tez/transform_ppr2.q.out
+++ b/ql/src/test/results/clientpositive/tez/transform_ppr2.q.out
@@ -263,6 +263,7 @@ STAGE PLANS:
                         columns.types string:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out b/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out
index 3b89d61..d4dad4e 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out
@@ -339,6 +339,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -715,6 +716,7 @@ STAGE PLANS:
                             columns.types string:string:int:int
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -922,6 +924,7 @@ STAGE PLANS:
                             columns.types string:string:int
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1197,6 +1200,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1484,6 +1488,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:int:int
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1806,6 +1811,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:int:int
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2118,6 +2124,7 @@ STAGE PLANS:
                         columns.types int:string:string:string:string:int:string:double:string
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2410,6 +2417,7 @@ STAGE PLANS:
                           columns.types int:string:string:string:string:int:string:double:string
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2675,6 +2683,7 @@ STAGE PLANS:
                             columns.types string:string:int:int
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2950,6 +2959,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3228,6 +3238,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3533,6 +3544,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3841,6 +3853,7 @@ STAGE PLANS:
                             columns.types string:string:bigint:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -4317,6 +4330,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:bigint:double:double:int:int
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -4555,6 +4569,7 @@ STAGE PLANS:
                         columns.types string:string:int
                         escape.delim \
                         hive.serialization.extend.additional.nesting.levels true
+                        serialization.escape.crlf true
                         serialization.format 1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -4849,6 +4864,7 @@ STAGE PLANS:
                             columns.types string:string:double:double
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -5826,6 +5842,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:bigint
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -6195,6 +6212,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:bigint
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -6532,6 +6550,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:bigint
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -6898,6 +6917,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:bigint
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -7280,6 +7300,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:bigint:bigint
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -7628,6 +7649,7 @@ STAGE PLANS:
                             columns.types string:string:int:int:int:bigint:bigint
                             escape.delim \
                             hive.serialization.extend.additional.nesting.levels true
+                            serialization.escape.crlf true
                             serialization.format 1
                             serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/transform_ppr1.q.out b/ql/src/test/results/clientpositive/transform_ppr1.q.out
index 99f7373..1a0f333 100644
--- a/ql/src/test/results/clientpositive/transform_ppr1.q.out
+++ b/ql/src/test/results/clientpositive/transform_ppr1.q.out
@@ -349,6 +349,7 @@ STAGE PLANS:
                   columns.types string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/transform_ppr2.q.out b/ql/src/test/results/clientpositive/transform_ppr2.q.out
index 2549e7f..f307f94 100644
--- a/ql/src/test/results/clientpositive/transform_ppr2.q.out
+++ b/ql/src/test/results/clientpositive/transform_ppr2.q.out
@@ -257,6 +257,7 @@ STAGE PLANS:
                   columns.types string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/udf_explode.q.out b/ql/src/test/results/clientpositive/udf_explode.q.out
index 21f5aa2..ec56b79 100644
--- a/ql/src/test/results/clientpositive/udf_explode.q.out
+++ b/ql/src/test/results/clientpositive/udf_explode.q.out
@@ -219,6 +219,7 @@ STAGE PLANS:
                   columns.types int:bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -493,6 +494,7 @@ STAGE PLANS:
                   columns.types int:string:bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/udtf_explode.q.out b/ql/src/test/results/clientpositive/udtf_explode.q.out
index f89ec97..40d3299 100644
--- a/ql/src/test/results/clientpositive/udtf_explode.q.out
+++ b/ql/src/test/results/clientpositive/udtf_explode.q.out
@@ -285,6 +285,7 @@ STAGE PLANS:
                   columns.types int:bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -595,6 +596,7 @@ STAGE PLANS:
                   columns.types int:string:bigint
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/union24.q.out b/ql/src/test/results/clientpositive/union24.q.out
index af885bc..8f4a9a1 100644
--- a/ql/src/test/results/clientpositive/union24.q.out
+++ b/ql/src/test/results/clientpositive/union24.q.out
@@ -321,6 +321,7 @@ STAGE PLANS:
                           columns.types string:bigint
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -356,6 +357,7 @@ STAGE PLANS:
                           columns.types string:bigint
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -391,6 +393,7 @@ STAGE PLANS:
                           columns.types string:bigint
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -416,6 +419,7 @@ STAGE PLANS:
                       columns.types string:bigint
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -970,6 +974,7 @@ STAGE PLANS:
                           columns.types string:bigint
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1005,6 +1010,7 @@ STAGE PLANS:
                           columns.types string:bigint
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1030,6 +1036,7 @@ STAGE PLANS:
                       columns.types string:bigint
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1599,6 +1606,7 @@ STAGE PLANS:
                           columns.types string:bigint
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1634,6 +1642,7 @@ STAGE PLANS:
                           columns.types string:bigint
                           escape.delim \
                           hive.serialization.extend.additional.nesting.levels true
+                          serialization.escape.crlf true
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1659,6 +1668,7 @@ STAGE PLANS:
                       columns.types string:bigint
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/union_ppr.q.out b/ql/src/test/results/clientpositive/union_ppr.q.out
index f5509ab..36805a6 100644
--- a/ql/src/test/results/clientpositive/union_ppr.q.out
+++ b/ql/src/test/results/clientpositive/union_ppr.q.out
@@ -283,6 +283,7 @@ STAGE PLANS:
                   columns.types string:string:string:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/vectorized_ptf.q.out b/ql/src/test/results/clientpositive/vectorized_ptf.q.out
index ff7b72c..3fa2735 100644
--- a/ql/src/test/results/clientpositive/vectorized_ptf.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_ptf.q.out
@@ -380,6 +380,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:int:double
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -791,6 +792,7 @@ STAGE PLANS:
                       columns.types string:string:int:int
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -992,6 +994,7 @@ STAGE PLANS:
                       columns.types string:string:int
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1308,6 +1311,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:int:double
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -1636,6 +1640,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:int:int:int
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2045,6 +2050,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:int:int:int
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2390,6 +2396,7 @@ STAGE PLANS:
                   columns.types int:string:string:string:string:int:string:double:string
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -2734,6 +2741,7 @@ STAGE PLANS:
                     columns.types int:string:string:string:string:int:string:double:string
                     escape.delim \
                     hive.serialization.extend.additional.nesting.levels true
+                    serialization.escape.crlf true
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3021,6 +3029,7 @@ STAGE PLANS:
                       columns.types string:string:int:int
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3337,6 +3346,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:int:double
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -3656,6 +3666,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:int:double
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -4049,6 +4060,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:int:double
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -4398,6 +4410,7 @@ STAGE PLANS:
                       columns.types string:string:bigint:double
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -4954,6 +4967,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:bigint:double:double:int:int
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -5233,6 +5247,7 @@ STAGE PLANS:
                   columns.types string:string:int
                   escape.delim \
                   hive.serialization.extend.additional.nesting.levels true
+                  serialization.escape.crlf true
                   serialization.format 1
                   serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -5613,6 +5628,7 @@ STAGE PLANS:
                       columns.types string:string:double:double
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -6809,6 +6825,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:int:bigint
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -7313,6 +7330,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:int:bigint
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -7738,6 +7756,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:int:bigint
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -8239,6 +8258,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:int:bigint
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -8709,6 +8729,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:int:bigint:bigint
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -9145,6 +9166,7 @@ STAGE PLANS:
                       columns.types string:string:int:int:int:bigint:bigint
                       escape.delim \
                       hive.serialization.extend.additional.nesting.levels true
+                      serialization.escape.crlf true
                       serialization.format 1
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/serde/if/serde.thrift b/serde/if/serde.thrift
index 2db27b5..405a2a5 100644
--- a/serde/if/serde.thrift
+++ b/serde/if/serde.thrift
@@ -27,6 +27,7 @@ const string SERIALIZATION_CLASS = "serialization.class"
 const string SERIALIZATION_FORMAT = "serialization.format"
 const string SERIALIZATION_DDL = "serialization.ddl"
 const string SERIALIZATION_NULL_FORMAT = "serialization.null.format"
+const string SERIALIZATION_ESCAPE_CRLF = "serialization.escape.crlf"
 const string SERIALIZATION_LAST_COLUMN_TAKES_REST = "serialization.last.column.takes.rest"
 const string SERIALIZATION_SORT_ORDER = "serialization.sort.order"
 const string SERIALIZATION_USE_JSON_OBJECTS = "serialization.use.json.object"
diff --git a/serde/src/gen/thrift/gen-cpp/serde_constants.cpp b/serde/src/gen/thrift/gen-cpp/serde_constants.cpp
index cc71b65..5213ee9 100644
--- a/serde/src/gen/thrift/gen-cpp/serde_constants.cpp
+++ b/serde/src/gen/thrift/gen-cpp/serde_constants.cpp
@@ -21,6 +21,8 @@ serdeConstants::serdeConstants() {
 
   SERIALIZATION_NULL_FORMAT = "serialization.null.format";
 
+  SERIALIZATION_ESCAPE_CRLF = "serialization.escape.crlf";
+
   SERIALIZATION_LAST_COLUMN_TAKES_REST = "serialization.last.column.takes.rest";
 
   SERIALIZATION_SORT_ORDER = "serialization.sort.order";
diff --git a/serde/src/gen/thrift/gen-cpp/serde_constants.h b/serde/src/gen/thrift/gen-cpp/serde_constants.h
index 418f666..62aa9c8 100644
--- a/serde/src/gen/thrift/gen-cpp/serde_constants.h
+++ b/serde/src/gen/thrift/gen-cpp/serde_constants.h
@@ -20,6 +20,7 @@ class serdeConstants {
   std::string SERIALIZATION_FORMAT;
   std::string SERIALIZATION_DDL;
   std::string SERIALIZATION_NULL_FORMAT;
+  std::string SERIALIZATION_ESCAPE_CRLF;
   std::string SERIALIZATION_LAST_COLUMN_TAKES_REST;
   std::string SERIALIZATION_SORT_ORDER;
   std::string SERIALIZATION_USE_JSON_OBJECTS;
diff --git a/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde/serdeConstants.java b/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde/serdeConstants.java
index e70d0c4..4ecd574 100644
--- a/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde/serdeConstants.java
+++ b/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde/serdeConstants.java
@@ -43,6 +43,8 @@
 
   public static final String SERIALIZATION_NULL_FORMAT = "serialization.null.format";
 
+  public static final String SERIALIZATION_ESCAPE_CRLF = "serialization.escape.crlf";
+
   public static final String SERIALIZATION_LAST_COLUMN_TAKES_REST = "serialization.last.column.takes.rest";
 
   public static final String SERIALIZATION_SORT_ORDER = "serialization.sort.order";
diff --git a/serde/src/gen/thrift/gen-php/org/apache/hadoop/hive/serde/Types.php b/serde/src/gen/thrift/gen-php/org/apache/hadoop/hive/serde/Types.php
index c1d8085..965036c 100644
--- a/serde/src/gen/thrift/gen-php/org/apache/hadoop/hive/serde/Types.php
+++ b/serde/src/gen/thrift/gen-php/org/apache/hadoop/hive/serde/Types.php
@@ -26,6 +26,8 @@ $GLOBALS['serde_CONSTANTS']['SERIALIZATION_DDL'] = "serialization.ddl";
 
 $GLOBALS['serde_CONSTANTS']['SERIALIZATION_NULL_FORMAT'] = "serialization.null.format";
 
+$GLOBALS['serde_CONSTANTS']['SERIALIZATION_ESCAPE_CRLF'] = "serialization.escape.crlf";
+
 $GLOBALS['serde_CONSTANTS']['SERIALIZATION_LAST_COLUMN_TAKES_REST'] = "serialization.last.column.takes.rest";
 
 $GLOBALS['serde_CONSTANTS']['SERIALIZATION_SORT_ORDER'] = "serialization.sort.order";
diff --git a/serde/src/gen/thrift/gen-py/org_apache_hadoop_hive_serde/constants.py b/serde/src/gen/thrift/gen-py/org_apache_hadoop_hive_serde/constants.py
index 7d7608f..e751b23 100644
--- a/serde/src/gen/thrift/gen-py/org_apache_hadoop_hive_serde/constants.py
+++ b/serde/src/gen/thrift/gen-py/org_apache_hadoop_hive_serde/constants.py
@@ -14,6 +14,7 @@
 SERIALIZATION_FORMAT = "serialization.format"
 SERIALIZATION_DDL = "serialization.ddl"
 SERIALIZATION_NULL_FORMAT = "serialization.null.format"
+SERIALIZATION_ESCAPE_CRLF = "serialization.escape.crlf"
 SERIALIZATION_LAST_COLUMN_TAKES_REST = "serialization.last.column.takes.rest"
 SERIALIZATION_SORT_ORDER = "serialization.sort.order"
 SERIALIZATION_USE_JSON_OBJECTS = "serialization.use.json.object"
diff --git a/serde/src/gen/thrift/gen-rb/serde_constants.rb b/serde/src/gen/thrift/gen-rb/serde_constants.rb
index 33f12b0..6b55be6 100644
--- a/serde/src/gen/thrift/gen-rb/serde_constants.rb
+++ b/serde/src/gen/thrift/gen-rb/serde_constants.rb
@@ -17,6 +17,8 @@ SERIALIZATION_DDL = %q"serialization.ddl"
 
 SERIALIZATION_NULL_FORMAT = %q"serialization.null.format"
 
+SERIALIZATION_ESCAPE_CRLF = %q"serialization.escape.crlf"
+
 SERIALIZATION_LAST_COLUMN_TAKES_REST = %q"serialization.last.column.takes.rest"
 
 SERIALIZATION_SORT_ORDER = %q"serialization.sort.order"
diff --git a/serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarSerDe.java b/serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarSerDe.java
index a611c05..0ca8e2d 100644
--- a/serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarSerDe.java
+++ b/serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarSerDe.java
@@ -55,6 +55,7 @@
     serdeConstants.LIST_COLUMNS, serdeConstants.LIST_COLUMN_TYPES,
     serdeConstants.FIELD_DELIM, serdeConstants.COLLECTION_DELIM, serdeConstants.MAPKEY_DELIM,
     serdeConstants.SERIALIZATION_FORMAT, serdeConstants.SERIALIZATION_NULL_FORMAT,
+    serdeConstants.SERIALIZATION_ESCAPE_CRLF,
     serdeConstants.SERIALIZATION_LAST_COLUMN_TAKES_REST,
     serdeConstants.ESCAPE_CHAR,
     serdeConstants.SERIALIZATION_ENCODING,
@@ -112,11 +113,6 @@ public void initialize(Configuration conf, Properties tbl) throws SerDeException
         cachedObjectInspector, notSkipIDs, serdeParams.getNullSequence());
 
     super.initialize(size);
-    LOG.debug("ColumnarSerDe initialized with: columnNames="
-        + serdeParams.getColumnNames() + " columnTypes="
-        + serdeParams.getColumnTypes() + " separator="
-        + Arrays.asList(serdeParams.getSeparators()) + " nullstring="
-        + serdeParams.getNullString());
   }
 
   /**
diff --git a/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazySerDeParameters.java b/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazySerDeParameters.java
index 080f74c..f00ddd8 100644
--- a/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazySerDeParameters.java
+++ b/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazySerDeParameters.java
@@ -5,6 +5,8 @@
 import java.util.List;
 import java.util.Properties;
 
+import org.apache.commons.logging.Log;
+import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.hive.common.classification.InterfaceAudience.Public;
 import org.apache.hadoop.hive.common.classification.InterfaceStability.Stable;
@@ -25,6 +27,7 @@
 @Public
 @Stable
 public class LazySerDeParameters implements LazyObjectInspectorParameters {
+  public static final Log LOG = LogFactory.getLog(LazySerDeParameters.class.getName());
   public static final byte[] DefaultSeparators = {(byte) 1, (byte) 2, (byte) 3};
   public static final String SERIALIZATION_EXTEND_NESTING_LEVELS
   	= "hive.serialization.extend.nesting.levels";
@@ -37,10 +40,11 @@
   // The list of bytes used for the separators in the column (a nested struct 
   // such as Array<Array<int>> will use multiple separators).
   // The list of separators + escapeChar are the bytes required to be escaped.
-  private byte[] separators;	
+  private byte[] separators;
 
   private String nullString;
   private Text nullSequence;
+
   private TypeInfo rowTypeInfo;
   private boolean lastColumnTakesRest;
   private List<String> columnNames;
@@ -48,7 +52,7 @@
 
   private boolean escaped;
   private byte escapeChar;
-  private boolean[] needsEscape = new boolean[256];  // A flag for each byte to indicate if escape is needed. 
+  private boolean[] needsEscape = new boolean[256];  // A flag for each byte to indicate if escape is needed.
 
   private boolean extendedBooleanLiteral;
   List<String> timestampFormats;
@@ -56,7 +60,7 @@
   public LazySerDeParameters(Configuration job, Properties tbl, String serdeName) throws SerDeException {
    this.tableProperties = tbl;
    this.serdeName = serdeName;
-  	
+
     nullString = tbl.getProperty(
         serdeConstants.SERIALIZATION_NULL_FORMAT, "\\N");
     nullSequence = new Text(nullString);
@@ -72,8 +76,8 @@ public LazySerDeParameters(Configuration job, Properties tbl, String serdeName)
     rowTypeInfo = TypeInfoFactory.getStructTypeInfo(columnNames, columnTypes);
 
     collectSeparators(tbl);
-  	
-    // Get the escape information      
+
+    // Get the escape information
     String escapeProperty = tbl.getProperty(serdeConstants.ESCAPE_CHAR);
     escaped = (escapeProperty != null);
     if (escaped) {
@@ -82,8 +86,18 @@ public LazySerDeParameters(Configuration job, Properties tbl, String serdeName)
       for (byte b : separators) {
         needsEscape[b & 0xFF] = true;         // Converts the negative byte into positive index
       }
+
+      // '\r' and '\n' are reserved and can't be used for escape chars and separators
+      if (needsEscape['\r'] || needsEscape['\n']) {
+        throw new SerDeException("\\r and \\n cannot be used as escaping characters or separators");
+      }
+      boolean isEscapeCRLF = Boolean.valueOf(tbl.getProperty(serdeConstants.SERIALIZATION_ESCAPE_CRLF));
+      if (isEscapeCRLF) {
+        needsEscape['\r'] = true;
+        needsEscape['\n'] = true;
+      }
     }
-    
+
     extendedBooleanLiteral = (job == null ? false :
         job.getBoolean(ConfVars.HIVE_LAZYSIMPLE_EXTENDED_BOOLEAN_LITERAL.varname, false));
 
@@ -92,8 +106,14 @@ public LazySerDeParameters(Configuration job, Properties tbl, String serdeName)
     if (timestampFormatsArray != null) {
       timestampFormats = Arrays.asList(timestampFormatsArray);
     }
+
+    LOG.debug(serdeName + " initialized with: columnNames="
+        + columnNames + " columnTypes=" + columnTypes
+        + " separator=" + Arrays.asList(separators)
+        + " nullstring=" + nullString + " lastColumnTakesRest="
+        + lastColumnTakesRest + " timestampFormats=" + timestampFormats);
   }
-  
+
   /**
    * Extracts and set column names and column types from the table properties
    * @throws SerDeException
@@ -130,7 +150,7 @@ public void extractColumnInfo() throws SerDeException {
           + " elements while columns.types has " + columnTypes.size() + " elements!");
     }
   }
-  
+
   public List<TypeInfo> getColumnTypes() {
     return columnTypes;
   }
@@ -139,7 +159,7 @@ public void extractColumnInfo() throws SerDeException {
     return columnNames;
   }
 
-  public byte[] getSeparators() {   	
+  public byte[] getSeparators() {
     return separators;
   }
 
diff --git a/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazySimpleSerDe.java b/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazySimpleSerDe.java
index 47bc639..a6e47fc 100644
--- a/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazySimpleSerDe.java
+++ b/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazySimpleSerDe.java
@@ -70,6 +70,7 @@
     serdeConstants.LIST_COLUMNS, serdeConstants.LIST_COLUMN_TYPES,
     serdeConstants.FIELD_DELIM, serdeConstants.COLLECTION_DELIM, serdeConstants.MAPKEY_DELIM,
     serdeConstants.SERIALIZATION_FORMAT, serdeConstants.SERIALIZATION_NULL_FORMAT,
+    serdeConstants.SERIALIZATION_ESCAPE_CRLF,
     serdeConstants.SERIALIZATION_LAST_COLUMN_TAKES_REST,
     serdeConstants.ESCAPE_CHAR,
     serdeConstants.SERIALIZATION_ENCODING,
@@ -128,12 +129,6 @@ public void initialize(Configuration job, Properties tbl)
     cachedLazyStruct = (LazyStruct) LazyFactory
         .createLazyObject(cachedObjectInspector);
 
-    LOG.debug(getClass().getName() + " initialized with: columnNames="
-        + serdeParams.getColumnNames() + " columnTypes=" + serdeParams.getColumnTypes()
-        + " separator=" + Arrays.asList(serdeParams.getSeparators())
-        + " nullstring=" + serdeParams.getNullString() + " lastColumnTakesRest="
-        + serdeParams.isLastColumnTakesRest() + " timestampFormats=" + serdeParams.getTimestampFormats());
-
     serializedSize = 0;
     stats = new SerDeStats();
     lastOperationSerialize = false;
diff --git a/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyUtils.java b/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyUtils.java
index eb53d3e..3abeb7e 100644
--- a/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyUtils.java
+++ b/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyUtils.java
@@ -151,10 +151,19 @@ public static void writeEscaped(OutputStream out, byte[] bytes, int start,
           if (i > start) {
             out.write(bytes, start, i - start);
           }
-          start = i;
-          if (i < len) {
-            out.write(escapeChar);
+
+          if (i == end) break;
+
+          out.write(escapeChar);
+          if (bytes[i] == '\r') {
+            out.write('r');
+            start = i + 1;
+          } else if (bytes[i] == '\n') {
+            out.write('n');
+            start = i + 1;
+          } else {
             // the current char will be written out later.
+            start = i;
           }
         }
       }
@@ -409,12 +418,19 @@ public static void copyAndEscapeStringDataToText(byte[] inputBytes, int start, i
       byte[] outputBytes = data.getBytes();
       for (int i = 0; i < length; i++) {
         byte b = inputBytes[start + i];
-        if (b != escapeChar || i == length - 1) {
-          outputBytes[k++] = b;
+        if (b == escapeChar && i < length - 1) {
+          ++i;
+          // Check if it's '\r' or '\n'
+          if (inputBytes[start + i] == 'r') {
+            outputBytes[k++] = '\r';
+          } else if (inputBytes[start + i] == 'n') {
+            outputBytes[k++] = '\n';
+          } else {
+            // get the next byte
+            outputBytes[k++] = inputBytes[start + i];
+          }
         } else {
-          // get the next byte
-          i++;
-          outputBytes[k++] = inputBytes[start + i];
+          outputBytes[k++] = b;
         }
       }
       assert (k == outputLength);
-- 
1.7.9.5

